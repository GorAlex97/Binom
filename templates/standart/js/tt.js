!function(t){var e={};function a(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=t,a.c=e,a.d=function(t,e,o){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(o,r,function(e){return t[e]}.bind(null,r));return o},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="templates/standart/js/",a(a.s=1023)}({1023:function(t,e,a){a(1024),a(1025),a(1026),a(1027),a(1028),t.exports=a(1029)},1024:function(t,e,a){"use strict";window.TtBuilder=function(t){var e=t;function a(t,e){var a="<colgroup>";return t.showedColumns.forEach((function(e,o){t.columns[e];a+=`<col data-column="${e}" class="${e}_td "></col>`})),{html:a+="</colgroup>"}}function o(t){var e=$(t.tableWrapperSelector).width();return"100%"==t.tableWidth?e:t.tableWidth}function r(t){var e="",r=a(t).html;return t.showedColumns.forEach((function(a,o){var r=t.columns[a]||Object.create(null),n=s(r),i=a+"_th",l="";t.checkbox&&a==t.mainSetColumns[0]&&(l='<div style="top:8px;left:0px;" class="checkrow checkallrows cute_checkbox "></div>',i+=" cell_with_checkbox");var c="";c=r.tab&&"stat"!=r.tab||t.blockSorting?"inactive":"active";var d=r.name?r.name:a;e+=`\n          <th data-column="${a}" class="${i}" style="${n}" >\n              <div class="header_table_th_content_wrapper" title="${d}">\n                ${l}\n                <span class="${c}"> ${d} </span>\n              </div>\n            <div data-column="${a}" class="resize-table-hook-${a} resize-table-hook"></div>\n            <div data-column="${a}" class="resize-table-hook-caret-${a} resize-table-hook-caret"></div>\n          </th>\n        `})),{html:`\n        <div class="tt_header_border_wrapper">\n          <div class="tt_header_wrapper" id="tt_header_wrapper" style="width:${o(t)}px;";>\n            <table class="tt_header_table" draggable="false">\n              ${r}\n              <tr draggable="false"> ${e} </tr>\n            </table>\n          </div>\n        </div>\n      `}}function n(t,a,o,r){var n;o=o||0;var i="",l="",c="";if("report"==a.tableKind){c="report_row";var d=t[a.reportLevelProp];1==d?c+=" row_level_1":2==d?c+=" row_level_2":3==d&&(c+=" row_level_3")}var u=!1;if(a.notesStatus){const e=t[a.notesStatus];u=!(!e||"0"==e)}var p=!1;"report"==a.tableKind&&t.tags&&t.tags.length&&t.tags.length>0&&(p=new Array,t.tags.forEach((function(t){try{p.push(JSON.parse(t))}catch(t){console.error("!CATCHED!"),console.error(t)}})));var h,f=!1;t[a.reportLevelProp]<a.reportLevels&&(f=!0),a.showedColumns.forEach((function(o,r){1;var n,i=a.columns[o]||{},c="";if(i.async)c=function(t,e,a){var o="";return"<td class="+(e.key+"_td")+' style="'+(o+=s(e))+'" >'+(a.asyncDataTabLoaded?"":asyncAnimation)+"</td>"}(t[o],i,a);else{var d={};if("report"==a.tableKind)p&&0==r&&(d.tagged=p),f&&0==r&&(d.reportToggle=!0);else if(a.notesStatus){const t=a.starIconColumn||"name";d.noteStar=u&&o==t}if(n=t[o],"name"==o)if("undefined"!=typeof BINOM&&"landing_page"==BINOM.__page){var h=t.lang||"";n=[t[o],h],t.is_banned&&"1"==t.is_banned&&(d.cellAlarm=!0,d.nameTitle="Lander’s domain is banned")}else if("undefined"!=typeof BINOM&&"offers"==BINOM.__page){var m;m="1"!=t.auto_payout?t.payout||"":"auto",n=[t[o],m],t.currency&&(n[2]=t.currency),t.is_banned&&"1"==t.is_banned&&(d.cellAlarm=!0,d.nameTitle="Offer’s domain is banned")}else if("undefined"!=typeof BINOM&&"campaigns"==BINOM.__page){var w=t.rotation_name;n=[t[o],w],t.is_banned&&"1"==t.is_banned&&(d.cellAlarm=!0,d.nameTitle="Campaign’s domain is banned"),null!==t.camp_ts_integration_id&&(d.thirdPartyEnabled=!0)}else"undefined"!=typeof BINOM&&"traffic_sources"==BINOM.__page&&null!==t.ts_integration_id&&(d.thirdPartyEnabled=!0);c=function(t,a,o,r,n=[]){var i,l=a.key+"_td",c="",d="",u="",p=s(a),h="";if(i=Array.isArray(t)?t[0]:t,3==window.TT_COLORIZE&&BINOM.tt.tableDataCalculated.minMaxColumnValues[a.key]&&"string"!=a.format&&"clicklog"!=BINOM.__page){var f=BINOM.tt.tableDataCalculated.minMaxColumnValues[a.key].min,m=BINOM.tt.tableDataCalculated.minMaxColumnValues[a.key].max,w=getProportianalTransparentCellColor(f,m,i,!0);h='data-tt-colorize-cell="1"',c+="background:"+w.bgColor+";",w.fontColor&&(c+="color: "+w.fontColor+";")}if("string"==a.format&&(i=(""+i||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")),a.bold&&(c+="font-weight:bold;"),c+=p,o.checkbox&&a.key==o.mainSetColumns[0]&&(d+='<span><div class="checkrow cute_checkbox"></div></span>',l+=" cell_with_checkbox"),r.cellAlarm&&(l+=" cell_alarm"),r.tagged&&r.tagged.forEach((function(t){if("tag_ico"==t.type){var e="";e=-1==t.name.indexOf("tag")?"tag_"+t.name+".png":t.name+".png";var a=t.create_date||"";d+=`<img title="${a}" src="templates/standart/images/tags/${e}" class="tag_ico">`,"tag_pause"!=t.name&&"tag_delete"!=t.name||(c+="color:gray;")}else"lang"==t.type&&(u+=`<span class="tag_lang">${t.name}</span>`)})),r.reportToggle&&(d+='<span class="report_row_toggler report_row_toggler_up"></span>'),void 0!==i&&null!=i||a.generated){var b=e.formatString(i,a.formatters,a.key,n);"name"==a.key?r.nameTitle?d+=`<span title="${r.nameTitle}">${b}</span>`:d+="<span>"+b+"</span>":d+=b}else i="";if(r.noteStar&&(d+='<img style="margin-left:4px;" width="9px" src="templates/standart/images/green-star.png">'),r.thirdPartyEnabled&&(d+='<span class="report-row-third-party-icon"></span>'),"name"==a.key)if("undefined"!=typeof BINOM&&"landing_page"==BINOM.__page){if(Array.isArray(t)){var g=t[1]||"";u+=`<span style="color: #aaa;"> ${g} </span>`}}else if("undefined"!=typeof BINOM&&"offers"==BINOM.__page){var _=t[1]||"";try{let e="$";if(void 0!==t[2]){const a=t[2];e=window.BINOM.defaultLists.getCurrencySign(a)}"auto"!=_&&(_=e+parseInt(100*+_)/100)}catch(t){}u+=` <span style="color: #aaa;"> ${_} </span>`}else if("undefined"!=typeof BINOM&&"campaigns"==BINOM.__page){var O=t[1]||"";u+=` <span style="color:#aaa;">${O}</span> `}return`<td style="${c}" class="${l}" ${h}><span>${d+u}</span></td>`}(n,i,a,d,t)}l+=c}));let m="";if("function"==typeof a.leftBorderCustomizer){m=`border-left: 4px solid ${a.leftBorderCustomizer(t)};`}var w=(h=checkForTrColorize(t.roi,t.profit))[0]||"",b=h[1]||"",g="",_="";if(a.unique&&a.uniqueDataAttr)_=`data-tt-row-uid="${String(t[a.unique])}"`;else if(a.unique&&"report"!=a.tableKind){g='id="ttrowuid'+String(t[a.unique]).replace(/\s/g,"_")+'"'}else"report"==a.tableKind&&(g='id="ttrowuid'+o+'"');var O="",v="";"report"==a.tableKind&&(O='data-level="'+t[a.reportLevelProp]+'"',v='data-parent="'+r+'"');var k="";t.tt&&t.tt.marked&&(k+="selected_row"),n=c+" "+b+" "+k;var y=w+m,S="";return a.deletedStatus&&0==t[a.deletedStatus]&&(S="deleted_item"),{html:i+=`<tr ${g} ${O} ${v} style="${y}" class="${n} ${S}" ${_} > `+l+"</tr>"}}function s(t){return(t=t||Object.create(null)).align?`text-align:${t.align};`:"text-align:right;"}function i(t,r){void 0===t&&(t=new Array);var n,i="";n=!1===r.footerDraw?new Array:"stats"==r.tableKind||"report"==r.tableKind?t:new Array;var l=a(r).html;return r.showedColumns.forEach((function(t){var a,o=r.columns[t]||{},l=s(o);const c=o.footerCalc&&o.footerCalc.noFormat;!o.footer||void 0===n[t]||!1===n[t]||isNaN(n[t])&&!c?a="":(a=n[t],c||(a=e.formatString(a,o.formatters,t,n)));var d="";o.bold&&(d+="font-weight:bold;"),d+=l;var u="";o.tab&&(u="undertab "+o.tab+"_tab "),i+=` <td\n                  class="${u+(""==a?" empty_footer_td ":"")+t}_footer_td"                  style="${d}" >\n                  <span>${a}</span>\n                </td> `})),{html:`\n      <div class="tt_footer_border_wrapper">        <div class="tt_footer_wrapper" style="width:${o(r)}px;";>          <table class="tt_footer_table">            ${l}\n            ${i}\n          </table>        </div>      </div>      `}}return{makeHeader:r,makeFooter:i,makeRowsArray:function(t,e){return"report"==e.tableKind?function(t,e){var a,o,r=new Array,s=-1,i=-1,l=-1;o=e.reportLevels?e.reportLevels:1,r=new Array;for(var c=0;c<t.length;c++)if(1!=t[c].hidedFromTt){var d=t[c];1==o||(1==(a=t[c].level)?(s=c,l=-1):2==a?(i=c,l=s):3==a&&(l=i)),t[c].reportParent=l;var u=n(d,e,c,l);r.push(u.html)}return r}(t,e):function(t,e){for(var a=new Array,o=0;o<t.length;o++)if(1!=t[o].hidedFromTt){var r=n(t[o],e,o);a.push(r.html)}return a}(t,e)},getHeaderFooterWidth:o,makeTableBaseDeep:function(t,e){var o=r(e).html,n=i(t,e).html,s="100%"==e.tableWidth?e.tableWidth:e.tableWidth+"px",l="";return e.fullWindowHeight||(l="height:100%;overflow-y:scroll;"),`\n                <div class="tt_full_wrapper">\n                  ${o}\n                  <div class="tt_data_view_wrapper" id="tt_data_view_wrapper" style="${l}">\n                    <div class="tt_data_wrapper" id="tt_data_wrapper"  style="width:${s};">\n                      <table class="tt_data_table">\n                        ${a(e).html}\n                        <tbody class="contentArea">\n                        </tbody>\n                      </table>\n                    </div>\n                  </div>\n                  ${n}\n                </div>\n      `},makeColgroup:a,getDigitsViaData:function(t,e){var a=(""+t[e]).split(".")[1]||"";return a.replace(/[\$\%\)]/g,"").length,a.replace(/[\$\%\)]/g,"").length}}}},1025:function(t,e,a){"use strict";window.TtFormatter=function(){var t={light:"#C62828",dark:"#C62828"},e={light:"#388E3C",dark:"#32CD32"},a={light:"#757575",dark:"#757575"};var o={dollarsign:function(t,e){return e=""+e,(t=parseFloat(t))<0||"-"==(""+e)[0]?"-$"+e.replace("-",""):"$"+e},percentagesign:function(t,e){return e+"%"},brackets:function(t,e){return(t=parseFloat(t))<0?"("+(e=e.replace("-",""))+")":e},threenumeralcommas:function(t,e){var a=""+e;return e=-1!=a.indexOf(".")?a.replace(/(?=\B(?:\d{3})+\b[\.])/g,","):a.replace(/(?=\B(?:\d{3})+\b)/g,",")},decimalplaces:function(t,e,a){return e},readonlyinput:function(t,e,a){return void 0===e&&(e=""),'<input style="width:100%" type="text" readonly value="'+e+'" />'},redgreengrey:function(o,r,n){var s=window.$rootStore.state.Settings.settings.appearance||"light",i=parseFloat(o);return i>0?'<span style="color:'+e[s]+'">'+r+"</span>":i<0?'<span style="color:'+t[s]+'">'+r+"</span>":'<span style="color:'+a[s]+'">'+r+"</span>"},timestamptodate:function(t,e){if(""==e)return"";var a,o=(a=new Date(1e3*parseInt(t))).getFullYear(),r=a.getMonth()+1;return r<10&&(r="0"+r),(a=a.getDate())<10&&(a="0"+a),o+"-"+r+"-"+a},timestamptodatetime:function(t,e){return""==e?"":moment.unix(e).format("YYYY-MM-DD HH:mm")},zeronone:function(t){return"0"==t?"none":t},nullisnone:function(t){return t&&"null"!=t?t:""},zeroempty:function(t){return"0"==t?"":t},yesno:function(t){return"0"==t&&(t=!1),t?"Yes":"No"},toint:function(t){return~~(t=parseInt(t))},timevalue:function(t){var e=+t;if(isNaN(e))return"";var a=Math.floor(e/3600),o=Math.floor((e-3600*a)/60);return(a>0?a+" h. ":"")+(o>0?o+" m. ":"")+Math.ceil(e-(3600*a+60*o))+" s."},usergrouptoword:function(t){switch(t=+t){case 1:return"Administrator";case 2:return"User";case 3:return'User <span style="color:#aaa">No Profit</span>'}},custommeasure:function(t,e,a){return e+""+BINOM.tt.tableOptions.columns[a].measure},oneisglobal:function(t){return 1==t?"Global":t},datetimetodate:function(t,e){return e.split(" ")[0]},colorcelltext:function(t,e,a,o){const{color:r=!1}=o;return r&&window.BINOM.COLORS_SET[r]?`<span style="color:${window.BINOM.COLORS_SET[r]};">${t}</span>`:t}};return{formatString:function(t,e,a,o){if(void 0===e)return t;var r=this.getFormatters(e)||[],n=t;return r.forEach((function(e){n=e(t,n,a,o)})),n},getFormatters:function(t){if("string"==typeof t)return o[t];if("object"==typeof t&&t.length>0){var e=new Array;return t.forEach((function(t){"object"==typeof t?(!function(t,e){o[t]=e}(t.name,t.func),e.push(o[t.name])):"string"==typeof name&&e.push(o[t])})),e}},getFormatterFunction:function(t){return o[t]},addFormatters:function(t,e){if("function"==typeof e){var a={};a[t]=e,this.formattersStorage.push(a)}}}}},1026:function(t,e){$(document).ready((function(){if(BINOM.ttSettingsAvailable=function(){if(-1==["campaigns","landing_page","offers","rotations","affiliate_networks","traffic_sources","stats"].indexOf(BINOM.__page))return!1;if("stats"==BINOM.__page&&1==URLUtils.getGETParamsAsObject().leads)return!1;return!0}(),-1!=["campaigns","landing_page","offers","affiliate_networks","traffic_sources","rotations","users"].indexOf(BINOM.__pageType)&&$("[name=search_name]").length){var t=0;$("[name=search_name]").on("input",(function(){var e=this;clearTimeout(t),t=setTimeout((function(){BINOM.tt.doSearch($(e).val()),"function"==typeof BINOM.tt.tableOptions.setButtonState&&BINOM.tt.tableOptions.setButtonState()}),300)}))}$("body").on("click",".header_table_th_content_wrapper",(function(t){t=t||event;var e=$(this).parent().attr("data-column");if(3==t.detail){if("SPAN"==t.target.tagName)return;BINOM.tt.stretchTable({unlimitColumns:[e]})}})),void 0!==window.orientation&&$(".table-wrapper").css("overflow-x",""),window.VmStoreSyncing={checkedRowsSync:function(){window.vmStore&&void 0!==BINOM.tt.markedRows&&void 0!==BINOM.tt.markedRows.checked&&(window.vmStore.commit("TT/setCheckedRows",BINOM.tt.markedRows.checked),window.vmStore.commit("TT/setMeaningfulSelectedRows",BINOM.tt.getCheckedMeaningful()))},selectedRowsSync:()=>{window.vmStore&&void 0!==BINOM.tt.markedRows&&void 0!==BINOM.tt.markedRows.selected&&(window.vmStore.commit("TT/setSelectedRows",BINOM.tt.markedRows.selected),window.vmStore.commit("TT/setMeaningfulCheckedRows",BINOM.tt.getSelectedMeaningful()))},meaningfulRowsSync:function(){window.vmStore&&void 0!==BINOM.tt.markedRows&&void 0!==BINOM.tt.markedRows.selected&&(window.vmStore.commit("TT/setMeaningfulSelectedRows",BINOM.tt.getCheckedMeaningful()),window.vmStore.commit("TT/setMeaningfulCheckedRows",BINOM.tt.getSelectedMeaningful()))},reportGroupsSync:()=>{window.vmStore&&void 0!==BINOM.tt.markedRows&&void 0!==BINOM.tt.markedRows.selected&&window.vmStore.commit("TT/SET_REPORT_GROUPS",BINOM.tt.tableOptions.reportGroups)},sync:()=>{window.VmStoreSyncing.checkedRowsSync(),window.VmStoreSyncing.selectedRowsSync(),window.VmStoreSyncing.meaningfulRowsSync()}},"1"!==window.BNM_DISABLE_SHORTCUTS&&(BINOM.ttKeyboard=new TtKeyboard)}))},1027:function(t,e,a){"use strict";window.TtStuff=function(){var t={loading:!1};this.startLoading=function(e){BINOM.tt.addLoadingLayer(e),t.loading=!0},this.endLoading=function(){BINOM.tt.removeLoadingLayer(),t.loading=!1,BINOM.tt.checkAndSetScrollbar()},this.fetchAndDrawTableData=function(t,e={},a){const o=void 0===e.clearChecked||e.clearChecked;void 0===e.transparentCoverLayer||e.transparentCoverLayer;let r;if(this.startLoading(!0),void 0===t){const t=URLUtils.getGETParamsAsObject();t.printdataasjson=1,r=URLUtils.getURLWithNewGETS(t)}else r=t;const n=BINOM.tt.tableOptions.tableWrapperElement.querySelector(".tt_data_view_wrapper"),s=n.scrollTop;fetch(r,{method:"GET",credentials:"include"}).then(t=>t.json()).then(t=>{o&&(BINOM.tt.markedRows.checked.splice(0),VmStoreSyncing.checkedRowsSync()),this.setAsyncFetchedDataToTT(t),this.endLoading(),n.scrollTop=s}).catch(t=>console.error(t))},this.fetchTableData=function(t,e){$.ajax({type:"get",url:t,success:function(t){"function"==typeof e&&e(t)}})},this.setAsyncFetchedDataToTT=function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}if("object"==typeof t){if(null==t.dataSet){if(t.error)return void new TtErrors(t.error);t.dataSet=new Array}t.dataSet&&BINOM.tt.setData(t.dataSet),t.total&&null!=t.dataSet&&0!=t.dataSet.length||(t.total=[]),t.total&&BINOM.tt.setTableTotal(t.total),t.pageOptions&&BINOM.tt.setPageOptions(t.pageOptions),BINOM.tt.redrawRows(),BINOM.tt.redrawFooter()}}},window.drawTTSettingsIcon=()=>{$(BINOM.tt.tableOptions.tableWrapperSelector).append('\n      <div class="tt_settings_button"></div>\n    '),$("body").on("click",".tt_settings_button",()=>{window.vmStore.commit("TT/OPEN_TT_SETTINGS_MODAL")})},window.TtKeyboard=function(){this.upDownBlocked=!1;this.ttKeyboardAvailable=function(){if(this.upDownBlocked)return!1;for(var t=$(".window"),e=0;e<t.length;e++)if(0!=t[e].offsetHeight)return!1;return!0},this.isFocusedInput=function(t){return $("body input:focus").length>0},this.arrowUpHandler=function(t){if(!this.isFocusedInput()&&(t.preventDefault(),!this.upDownBlocked)){t=t||event;var e=$(BINOM.tt.tableOptions.tableWrapperElement).find(".selected_row").prev();if(0!=e.length){var a=e[0].offsetTop,o=($(".tt_data_view_wrapper").height(),$(".tt_data_view_wrapper").scrollTop()),r=o-a;r>0&&$(".tt_data_view_wrapper").scrollTop(o-r-1),markRow(e)}else if(BINOM.tt.isClusterized()){var n=$(".tt_data_view_wrapper")[0].scrollHeight;$(".tt_data_view_wrapper").scrollTop(n);var s=this;this.upDownBlocked=!0,setTimeout((function(){markRow($(BINOM.tt.tableOptions.tableWrapperElement).find(".tt_data_table tr:last-child")),s.upDownBlocked=!1}),150)}else{var i=function(){var t=$(".tt_data_view_wrapper")[0].scrollHeight;return $(".tt_data_view_wrapper").scrollTop(t),$(BINOM.tt.tableOptions.tableWrapperElement).find(".tt_data_table tr:last-child"),$(BINOM.tt.tableOptions.tableWrapperElement).find(".tt_data_table tr:last-child")}();$(".tt_data_view_wrapper").scrollTop(n),markRow(i)}"function"==typeof BINOM.tt.tableOptions.setButtonState&&BINOM.tt.tableOptions.setButtonState()}},this.arrowDownHandler=function(t){if(!this.isFocusedInput()&&(t.preventDefault(),!this.upDownBlocked)){t=t||event;var e=$(BINOM.tt.tableOptions.tableWrapperElement).find(".selected_row").next();if(0!=e.length){var a=e[0].offsetTop,o=$(".tt_data_view_wrapper").height(),r=$(".tt_data_view_wrapper").scrollTop(),n=a-(o+r-25);n>0&&$(".tt_data_view_wrapper").scrollTop(r+n),markRow(e)}else if(BINOM.tt.isClusterized()){$(".tt_data_view_wrapper").scrollTop(0);var s=this;this.upDownBlocked=!0,setTimeout((function(){markRow($(BINOM.tt.tableOptions.tableWrapperElement).find(".tt_data_table tr:first-child")),s.upDownBlocked=!1}),150)}else{var i=$(BINOM.tt.tableOptions.tableWrapperElement).find(".tt_data_table tr:first-child");$(".tt_data_view_wrapper").scrollTop(0),markRow(i)}"function"==typeof BINOM.tt.tableOptions.setButtonState&&BINOM.tt.tableOptions.setButtonState()}},this.arrowLeftHandler=function(){this.isFocusedInput()||(BINOM.tt.tableOptions.tabOpen?BINOM.tt.closeTab():BINOM.tt.openTab())},this.arrowRightHandler=function(){this.isFocusedInput()||(BINOM.tt.tableOptions.tabOpen?BINOM.tt.closeTab():BINOM.tt.openTab())},this.enterHandler=function(){var t=$(".selected_row");t.length>0&&t.trigger("dblclick")},this.setHandler=function(){var t=this;$(document).on("keydown",(function(e){BINOM.keyPressed.shift?$(".tt_data_table").addClass("block_allocation"):$(".tt_data_table").removeClass("block_allocation");e=e||event;var a=getKeyCode(e);if(t.ttKeyboardAvailable())switch(a){case 38:t.arrowUpHandler(e);break;case 40:t.arrowDownHandler(e);break;case 37:t.arrowLeftHandler();break;case 39:t.arrowRightHandler();break;case 13:t.enterHandler()}})),$(window).blur((function(){$(".tt_data_table").removeClass("block_allocation")}))},this.init=function(){this.setHandler()}},window.TtPagination=function(t){var e=(t=t||{}).clicklog||!1;this.makePaginationBlock=function(){var t,a,o,r=(()=>{var t,e,a="",o=(a="",BINOM.tt.pageOptions);void 0!==o?(t=o.amountOfPages,e=o.numPage):(t=1,e=1);for(var r=1;r<=t;r++)a+="<option value="+r+" "+(r==e?"selected":"")+" >"+r+"</option>";return'        <select style="width:60px;" class="num_page_select">          '+a+"        </select>"})(),n=`\n        <select style="width:60px;" class="amount_on_page_select">\n          <option value="50"   ${50==(t=BINOM.tt.pageOptions?BINOM.tt.pageOptions.amountOnPage:1)?"selected":""}>50</option>\n          <option value="100"  ${100==t?"selected":""}>100</option>\n          <option value="200"  ${200==t?"selected":""}>200</option>\n          <option value="500"  ${500==t?"selected":""}>500</option>\n          <option value="1000" ${1e3==t?"selected":""}>1000</option>\n          ${e?"":`<option value="All"  ${"All"==t?"selected":""}>All</option>`}\n        </select>`,s=BINOM.tt.pageOptions;return void 0!==s?(a=s.numPage,o=s.amountOfPages):(a=1,o=1),'      <div class="tt_report_pagination">        <span class="prev-page-button bnm-button '+(a<=1?"bnm-button--disabled":"bnm-button-gray")+'">Prev</span>        <span class="next-page-button bnm-button '+(a==o?"bnm-button--disabled":"bnm-button-gray")+'">Next</span>        '+r+'        <span class="amount-of-pages">/ '+o+"</span>        "+n+"      </div>    "},this.drawPaginationBlock=function(){if(!BINOM.tt.tableOptions.tableWrapperSelector)throw new Error("Try to do report stuff but TT is not drawed yet;");var t=BINOM.tt.tableOptions.tableWrapperSelector,e=this.makePaginationBlock();0==$(".tt_report_pagination").length?$(t).append(e):$(".tt_report_pagination").replaceWith(e)},this.numPageChange=function(t){if(BINOM.tt.isFetchingData)return;const e={num_page:$(t).val()};URLUtils.changeGETsInURL(e);const a={};"report"===BINOM.tt.tableOptions.tableKind&&(a.type_load=3),BINOM.tt.refetchData({saveScroll:!1,queryOptions:a})},this.amountOnPageChange=function(t){if(BINOM.tt.isFetchingData)return;const e=$(t).val(),a={val_page:e,num_page:1};BINOM.tt.pageOptions.amountOnPage=e,BINOM.tt.pageOptions.numPage=1,URLUtils.changeGETsInURL(a);const o={};"report"===BINOM.tt.tableOptions.tableKind&&(o.type_load=3),BINOM.tt.refetchData({saveScroll:!1,queryOptions:o})},this.nextButtonClick=function(t){if(BINOM.tt.isFetchingData)return;if((t=$(t)).hasClass("button_inactive"))return;var e=BINOM.tt.pageOptions.numPage;if(e==BINOM.tt.pageOptions.amountOfPages)return;const a={num_page:+e+1};URLUtils.changeGETsInURL(a);const o={};"report"===BINOM.tt.tableOptions.tableKind&&(o.type_load=3),BINOM.tt.refetchData({saveScroll:!1,queryOptions:o})},this.prevButtonClick=function(t){if(BINOM.tt.isFetchingData)return;if((t=$(t)).hasClass("button_inactive"))return;var e=BINOM.tt.pageOptions.numPage;BINOM.tt.pageOptions.amountOfPages;if(1==e)return;const a={num_page:+e-1};URLUtils.changeGETsInURL(a);const o={};"report"===BINOM.tt.tableOptions.tableKind&&(o.type_load=3),BINOM.tt.refetchData({saveScroll:!1,queryOptions:o})},this.setHandlers=function(){var t=this;$("body").on("click",".tt_report_pagination .prev-page-button",(function(){t.prevButtonClick(this)})),$("body").on("click",".tt_report_pagination .next-page-button",(function(){t.nextButtonClick(this)})),$("body").on("change",".tt_report_pagination .num_page_select",(function(){t.numPageChange(this)})),$("body").on("change",".tt_report_pagination .amount_on_page_select",(function(){t.amountOnPageChange(this)}))},this.init=function(){this.drawPaginationBlock(),this.setHandlers()}},window.TtErrors=function(t,e){function a(t,e){var a=function(t){var e={type:"error",header:"Error!",subheader:"\n        <span>An error occurred while build the table.</span><br>\n        <span>Please, contact our support.</span>\n      ",text:t};return'<div class="tt_error_wrapper">'+BINOM.UTILS.makeInnerMessage(e)+"</div>"}(t);$(e).html(a)}t instanceof Error&&(t=`<pre>${t.message}  ${t.stack}</pre>`),void 0===(e=e||BINOM.tt.tableOptions.tableWrapperSelector)&&console.error("#TTERRORS block to draw undefined"),a(t,e)}},1028:function(t,e,a){"use strict";window.TtFactory=function(t){return new Tt(t)},window.Tt=function(t){var e=this,a=TtFormatter(),o=TtBuilder(a),r=0,n=null;new Array;this.handlersState={checkbox:!1,checkboxAll:!1},this.isFetchingData=!1,this.markedRows={checked:[],selected:[],lastMarked:null},this.localStorageIsActive=(()=>{if("object"!=typeof localStorage)return!1;try{return localStorage.setItem("localStorage",1),localStorage.removeItem("localStorage"),!0}catch(t){return!1}})(),this.StorageUtils={getStorageValue:function(t){if(e.localStorageIsActive)var a=localStorage[t];else a=$.cookie(t);try{a=JSON.parse(a)}finally{return a}},setStorageValue:function(t,a){return"object"==typeof a&&(a=JSON.stringify(a)),e.localStorageIsActive?localStorage[t]=a:$.cookie(t,a,{expires:1})}},this.tableData=new Array,this.renderedArrRows=new Array,this.rowRenderCallbacks=[],this.columnWidthFromStorage=!1,this.tableOptions=Object.create(null),this.asyncLastHourData=null,this.getFormatter=function(){return a},this.isClusterized=function(){return null!=n},this.readStorage=function(t){var e;t=this.tableOptions.uid+"_"+t;try{e=JSON.parse(localStorage.getItem(t))}catch(a){e=localStorage.getItem(t)}return e},this.writeStorage=function(t,e){t=this.tableOptions.uid+"_"+t,localStorage.setItem(t,e)},this.getBuilder=function(){return o},this.tableOptions=t,this.tableOptions.scrollWidth=getScrollWidth(),this.tableOptions.sortingOptions=Object.create(null),this.tableOptions.tabOpen=!1,this.tableOptions.availableColumns&&!this.tableOptions.mainSetColumns&&(this.tableOptions.mainSetColumns=this.tableOptions.availableColumns),this.tableOptions.showedColumns=this.tableOptions.mainSetColumns;var s=this.tableOptions.tableWrapperElement,i=$(s);this.localStorageIsActive&&(1==localStorage.getItem("typeStatState")&&void 0!==this.tableOptions.underTabColumns&&this.tableOptions.underTabColumns.length&&(this.tableOptions.showedColumns=this.tableOptions.underTabColumns,this.tableOptions.tabOpen=!0));this.tableOptions.asyncDataTabLoaded=!1,this.calculateWidthForColumns=function(){var t,e,a=(t=this.tableOptions,e={},t.showedColumns.forEach((function(a){if(void 0===t.columns[a])throw new Error("Columns defined in table settings was not defined in `columns` settings. #"+a);e[a]=100})),e),o=this.readStorage("columnsWidth"),r={};return this.tableOptions.showedColumns.forEach((function(t){null!=o&&o[t]?r[t]=o[t]:r[t]=a[t]})),r},this.setWidthForColumns=function(){var t,e=this.tableOptions.columnWidth;for(t in e)i.find(`.tt_full_wrapper col.${t}_td`).css("width",e[t])},this.correlateTableHeight=function(){var t=$(this.tableOptions.tableWrapperSelector).offset().top;t!=r&&(r=t);var e,a;document.getElementById("tt_data_wrapper").offsetTop;a=void 0!==window.orientation?document.documentElement.clientHeight:window.innerHeight,e=this.isBrowserFirefox?a-r-80:a-r-70,this.tableOptions.fullWindowHeight&&i.find(".tt_data_view_wrapper").css("height",e+"px")},this.destroyClusterize=function(){null!=n&&(n.clear(),n=null)},this.isBrowserFirefoxOrSafari=function(){if(window.navigator){var t=window.navigator.userAgent.search("Firefox"),e=window.navigator.userAgent.search("Safari"),a=!1;if(-1!=t)a=!0;else if(-1!=e){-1==navigator.userAgent.search("Chrome")&&(a=!0)}return a}return null}(),this.isBrowserFirefox=function(){if(window.navigator)return-1!=window.navigator.userAgent.search("Firefox")}(),this.clusterizeNeeded=function(){var t=this.tableData.length>300,e=void 0===window.orientation,a="report"!=this.tableOptions.tableKind;this.isBrowserFirefoxOrSafari;return t&&e&&a},this.insertRowsInTable=function(t){var e=this;this.clusterizeNeeded()||null!=n?null!=n?n.update(t):n=new Clusterize({scrollElem:s.querySelector(".tt_data_view_wrapper"),contentElem:s.querySelector(".contentArea"),rows:t,callbacks:{clusterWillChange:function(){},clusterChanged:function(){e.markedRows.selected.forEach((function(t){$("#ttrowuid"+t).addClass("selected_row")})),e.markedRows.checked.forEach((function(t){$("#ttrowuid"+t).addClass("checked_row"),$("#ttrowuid"+t).find(".checkrow").addClass("checked")})),e.tableOptions.tabOpen&&e.tableOptions.asyncDataTabLoaded&&($(".uil-async-css").replaceWith("-"),e.drawLastHourDataInTable())}}}):(i.find(".contentArea").html(t),e.markedRows.selected.forEach((function(t){$("#ttrowuid"+t).addClass("selected_row")})),e.markedRows.checked.forEach((function(t){$("#ttrowuid"+t).addClass("checked_row"),$("#ttrowuid"+t).find(".checkrow").addClass("checked")})))},this.getClusterize=function(){return n},this.checkDataOnErrors=t=>{if("string"==typeof t&&"no_clicks"!=t&&(t=JSON.parse(t)),null!=t&&t.error){var e="";throw e="string"==typeof t.error?t.error:t.error.errorInfo?t.error.errorInfo:"error",TtErrors(e,"#table-block"),new Error("Cant draw Table.")}},this.events={events:{},on(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)},off(t,e){if(this.events[t]){const a=this.events[t].indexOf(e);a>-1&&this.events[t].splice(a,1)}},emit(t,e){const a=this.events[t];a&&a.forEach(t=>t(e))}},this.tableDataCalculated={},this.setTableDataCalculatedOnSetData=function(t){this.setMinMaxValues(t),this.setRowsCountByLevel(t)},this.setRowsCountByLevel=function(t){const e={1:0,2:0,3:0};for(let a=0;a<t.length;a++){e[t[a].level]++}this.tableDataCalculated.rowsCountByLevel=e},this.setMinMaxValues=function(t){if(!t.length)return this.tableDataCalculated.minMaxColumnValues={};var e={};this.tableOptions.showedColumns.forEach(a=>{"number"!=typeof parseFloat(t[0][a])||isNaN(parseFloat(t[0][a]))||"id"==a||this.tableOptions.listOfStringColumns.includes(a)||(e[a]={},e[a].min=parseFloat(t[0][a]),e[a].max=parseFloat(t[0][a]))});for(var a=1;a<t.length;a++)for(var o in e)t[a][o]<e[o].min&&(e[o].min=parseFloat(t[a][o])),t[a][o]>e[o].max&&(e[o].max=parseFloat(t[a][o]));this.tableDataCalculated.minMaxColumnValues=e},this.setData=function(t){if(this.checkDataOnErrors(t),"string"==typeof t)try{t="no_clicks"==t?new Array:JSON.parse(t)}catch(t){throw new Error("Cant parse ")}else if(null==t)t=new Array;else if("object"!=typeof t)throw new Error("Cant parse data to draw");if("function"==typeof this.tableOptions.preDrawRowsDataEditing&&(t=this.tableOptions.preDrawRowsDataEditing(t)),t.length>1&&"stats"==this.tableOptions.tableKind&&!this.tableOptions.blockSorting&&this.presortingOnSetData(t),this.setTableDataCalculatedOnSetData(t),this.tableData=t,this.searchInputElement){const t=this.searchInputElement.value;this.applySearchOnTableData(t)}this.events.emit("dataChange",this.tableData)},this.presortingOnSetData=function(t){var e=this.getSortingData();void 0!==t[0][e.column]?(t=this.sortArray(t,e.column,e.direction),this.sortingOptions={column:e.column,direction:e.direction}):(e={direction:"DESC",column:"clicks"},this.sortingOptions=e,this.setSortingData(e),t=this.sortArray(t,e.column,e.direction))},this.setTableTotal=function(t){this.tableTotal=void 0!==t?t:[]},this.setPageOptions=function(t){if(void 0!==t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){console.error("Incorrect pageOptions data"),console.error(t)}this.pageOptions=t,BINOM.ttPagination&&BINOM.ttPagination.drawPaginationBlock()}},this.editInRenderedRowsArray=function(t,e){if(null==this.renderedArrRows||0==this.renderedArrRows.length)return null;if("function"==typeof e){for(var a,o,r=0,n=this.renderedArrRows.length;r<n;r++)if((a=document.createElement("template")).innerHTML=this.renderedArrRows[r],a.content.childNodes[0].getAttribute("id").replace("ttrowuid","")==t){this.renderedArrRows[r]=e(this.renderedArrRows[r]),o=this.renderedArrRows[r];break}return o}},this.updateRowViaClusterize=function(t,e){var a=this.editInRenderedRowsArray(t,e);this.isClusterized();this.isClusterized()?this.getClusterize().update(this.renderedArrRows):$("#ttrowuid"+t).replaceWith(a)},this.updateRow=function(t,e){this.updateRowViaClusterize(t,e)},this.getFooterTotal=function(t=this.tableData,e=this.tableOptions){var a={},o=[];e.showedColumns.forEach((function(t){var a=e.columns[t]||{};a.footer&&-1==o.indexOf(t)&&o.push(t),a.footer&&a.footerCalc&&a.footerCalc.neededColumns&&a.footerCalc.neededColumns.forEach((function(t){-1==o.indexOf(t)&&o.push(t)}))})),o.forEach((function(o){var r=e.columns[o]||TT_DEFAULT_OPTIONS.columns[o]||{};!1===r.footer?(console.warn(`Column settings for column ${o} setted as false but needed for footer. Calculate as sum.`),r.footer=!0,r.footerCalc="sum"):void 0===r.footer&&(console.warn(`Column settings for column ${o} not found. Calculate as sum.`),r.footer=!0,r.footerCalc="sum");for(var n=0,s=0,i=0;i<t.length;i++)if(!t[i].hidedFromTt){const e=t[i][o]||0;n+=parseFloat(e),s++}"sum"==r.footerCalc||void 0===r.footerCalc?a[o]=n:"average"==r.footer?a[o]=n/s:"averageSmart"==r.footer&&(a[o]=n)})),e.showedColumns.forEach((function(t){var o=e.columns[t]||{};if(o.footer&&o.footerCalc&&o.footerCalc.basedOnFinal&&"average"!==o.footer){if("function"!=typeof o.footerCalc.calcFunc)throw new Error("Undefined type of calcFunc "+typeof o.footerCalc.calcFunc);a[t]=o.footerCalc.calcFunc(a)}}));return this.fixDecimalsInFooterSum(a)},this.getDigitsViaData=(t,e)=>{var a=(""+t[e]).split(".")[1]||"";a.replace(/[\$\%\)]/g,"").length;return a.replace(/[\$\%\)]/g,"").length},this.fixDecimalsInFooterSum=t=>{let e=t;if(this.tableData.length>0){const a=Object.keys(t),o={};a.forEach(e=>{const a=this.tableOptions.columns[e]||{};if(a.footerCalc&&a.footerCalc.noFormat)return void(o[e]=t[e]);const r=this.getDigitsViaData(this.tableData[0],e),n=(+t[e]).toFixed(r);o[e]=n}),e=o}return e},this.fillReportFooterSum=(t=this.tableTotal)=>{const{availableColumns:e,columns:a}=BINOM.tt.tableOptions;return e.forEach(e=>{const o=a[e];o.footer&&o.footerCalc&&o.footerCalc.calcFuncGeneratedFromFormula&&"average"!==o.footer&&(t[e]=o.footerCalc.calcFunc(t))}),t},this.draw=function(){var t="";if(this.tableTotal)if(this.tableData){this.tableTotal=this.fillReportFooterSum();const e=this.fixDecimalsInFooterSum(this.tableTotal);t=o.makeTableBaseDeep(e,this.tableOptions)}else t=o.makeTableBaseDeep([],this.tableOptions),console.error("Tt is report and total was not set. ");else{const e=this.getFooterTotal(this.tableTotal,this.tableOptions);t=o.makeTableBaseDeep(e,this.tableOptions)}$(this.tableOptions.tableWrapperSelector+" .tt_full_wrapper").remove(),$(this.tableOptions.tableWrapperSelector).prepend(t);var e=o.makeRowsArray(this.tableData,this.tableOptions);this.renderedArrRows=e,this.insertRowsInTable(e),this.correlateTableHeight(),this.postDraw(),this.stretchTable();var a=this.getSortingData();"stats"!=this.tableOptions.tableKind||this.tableOptions.blockSorting||this.addArrowToTh(a.direction,a.column),this.tableOptions.tabOpen&&(this.tableOptions.asyncDataTabLoaded?this.drawLastHourDataInTable():this.loadLastHour())},this.observersRedraw=Object.create(null),this.addRedrawObserver=function(t,e){"string"==typeof t&&"function"==typeof e?this.observersRedraw[t]=e:(console.error("Cant add observer for tt redraw"),console.error(t,e))},this.getRedrawObserver=function(){return observersRedraw},this.removeRedrawObserver=function(t){"string"==typeof t&&delete this.observersRedraw[t]},this.twitchObervsersRedraw=function(){var t;for(t in this.observersRedraw)this.observersRedraw[t]()},this.redraw=function(t){this.addLoadingLayer(),n=null,e.dataWrapperWithScroll=!1,this.draw(),this.removeLoadingLayer(),this.twitchObervsersRedraw()},this.redrawRows=function(t={}){const{saveScroll:e=!1,clearMarked:a=!1,redrawFooter:o=!1,redrawHeader:r=!1}=t;let n=0;if(e&&(n=s.querySelector(".tt_data_view_wrapper").scrollTop),this.reinitRows(),o&&this.redrawFooter(),r&&this.redrawHeader(),this.correlateHeaderFooter(),s.querySelector(".tt_data_view_wrapper").scrollTop=e?n:0,a){const t=s.querySelector(".checkallrows.checked");t&&t.classList.remove("checked")}VmStoreSyncing.selectedRowsSync()},this.redrawFooter=function(t){var e;if("report"==this.tableOptions.tableKind){t=t||this.tableTotal;const a=this.fixDecimalsInFooterSum(t);e=o.makeFooter(a,this.tableOptions).html}else{const t=this.getFooterTotal(this.tableData,this.tableOptions);e=o.makeFooter(t,this.tableOptions).html}i.find(".tt_footer_wrapper").parent().replaceWith(e),this.setWidthForColumns()},this.redrawHeader=function(){const t=o.makeHeader(this.tableOptions).html;if(i.find(".tt_header_wrapper").parent().replaceWith(t),BINOM.tt.setWidthForColumns(),!this.tableOptions.blockSorting){const{direction:t,column:e}=this.getSortingData();this.addArrowToTh(t,e)}},this.postDraw=function(){this.correlateHeaderFooter()},this.correlateHeaderFooter=function(){var t=i.find(".tt_data_wrapper").width();i.find(".tt_header_wrapper").css("width",t),i.find(".tt_footer_wrapper").css("width",t),e.checkAndSetScrollbar()},this.closeTab=function(){var t=i.find(".tt_data_view_wrapper").scrollTop();this.tableOptions.showedColumns=this.tableOptions.mainSetColumns,this.destroyClusterize(),this.redraw(),this.stretchTable(),this.tableOptions.tabOpen=!1,i.find(".tt_data_view_wrapper").scrollTop(t),this.localStorageIsActive&&localStorage.setItem("typeStatState",0)},this.openTab=function(){if(this.tableOptions.underTabColumns){var t=i.find(".tt_data_view_wrapper").scrollTop();this.tableOptions.showedColumns=this.tableOptions.underTabColumns,this.destroyClusterize(),this.redraw(),this.stretchTable(),this.tableOptions.tabOpen=!0,i.find(".tt_data_view_wrapper").scrollTop(t),this.tableOptions.asyncDataTabLoaded?this.drawLastHourDataInTable():this.loadLastHour(),this.localStorageIsActive&&localStorage.setItem("typeStatState",1)}else console.warn("Try to open tab without undertab settings.")},this.asyncTabDataFetched=!1,this.loadLastHour=function(){if(this.asyncTabDataFetched)return;this.asyncTabDataFetched=!1;var t=this;const e=new FormData;return e.append("ajax",1),e.append("type","get_last_hour_stats"),fetch("",{credentials:"include",method:"POST",body:e}).then(t=>t.json()).then(e=>{t.removeAsyncLoaderAnimation(),t.asyncLastHourData=e,t.drawLastHourDataInTable(),t.tableOptions.asyncDataTabLoaded=!0,this.asyncTabDataFetched=!1}).catch(t=>{console.error("Cant load lasthour data"),console.error(t)})},this.removeAsyncLoaderAnimation=function(){$(".uil-async-css").replaceWith("")},this.drawLastHourDataInTable=function(){var t=this;null!=this.asyncLastHourData&&this.asyncLastHourData.forEach((function(e){if($("#ttrowuid"+e.el_id).length>0){var a=e.clicks_lh,o=e.leads_lh,r=e.profit_lh,n=t.getFormatter().getFormatterFunction("timevalue"),s=(r=t.getFormatter().formatString(r,BINOM.tt.tableOptions.columns.profit_lh.formatters,"profit_lh"),n(e.last_lead));i.find("#ttrowuid"+e.el_id+" .clicks_lh_td").html("<span>"+a+"</span>"),i.find("#ttrowuid"+e.el_id+" .leads_lh_td").html("<span>"+o+"</span>"),i.find("#ttrowuid"+e.el_id+" .profit_lh_td").html("<span>"+r+"</span>"),i.find("#ttrowuid"+e.el_id+" .last_lead_td").html("<span>"+s+"</span>")}}))},this.clearCheckedAndSelected=function(){$(this.tableOptions.tableWrapperSelector).find("tr.selected_row").removeClass("selected_row"),this.markedRows.selected.splice(0),$(this.tableOptions.tableWrapperSelector).find("tr.checked_row .cute_checkbox.checked").removeClass("checked"),$(this.tableOptions.tableWrapperSelector).find(".checkallrows.checked").removeClass("checked"),$(this.tableOptions.tableWrapperSelector).find("tr.checked_row").removeClass("checked_row"),this.markedRows.checked.splice(0),VmStoreSyncing.checkedRowsSync(),VmStoreSyncing.selectedRowsSync()},this.changeShowedColumns=function(t){var e=this,a=!1;if(this.tableData.length>100&&this.addLoadingLayer(),t.forEach((function(t){if(-1==e.tableOptions.columns[t])throw new Error("Can`t show "+t+" column. ")})),t.length!=e.tableOptions.showedColumns.length)a=!0;else{var o=!0;t.forEach((function(t){if(-1==e.tableOptions.showedColumns.indexOf(t))return o=!1,!1})),o||(a=!0)}a&&(e.tableOptions.mainSetColumns=t,e.tableOptions.tabOpen||(e.tableOptions.showedColumns=e.tableOptions.mainSetColumns,e.tableOptions.columnWidth=e.calculateWidthForColumns(),"100%"!=e.tableOptions.tableWidth&&(e.tableOptions.tableWidth=function(t){var e,a=0;for(e in t)a+=t[e];return a}(e.tableOptions.columnWidth)),e.redraw(),e.stretchTable(),$(window).trigger("resize"))),e.removeLoadingLayer()},this.getFactWidthOfNeighborColumn=function(t){var e=this.tableOptions.showedColumns.indexOf(t),a=this.tableOptions.showedColumns[e+1];return $(".tt_header_wrapper ."+a+"_th").outerWidth()},this.getDefaultWidthOfNeighborColumn=function(t){var e=this.tableOptions.showedColumns.indexOf(t),a=this.tableOptions.showedColumns[e+1];return this.tableOptions.columnWidth[a]},this.changeColumnWidth=function(t,e){this.tableOptions.sizeChanged||(this.tableOptions.sizeChanged=!0),(e=Math.floor(e))>700&&(e=700),e<45&&(e=45),e=e/$(this.tableOptions.tableWrapperSelector).width()*100+"%",$("col."+t+"_td").css("width",e)},this.makeResizeHooksAlive=function(){var t=this;$("body").on("mousedown",this.tableOptions.tableWrapperSelector+" .resize-table-hook",(function(e){var a=(e=e||event).pageX,o=$(e.target).attr("data-column"),r=t.tableOptions.showedColumns.indexOf(o),n=parseInt(i.find(`.${o}_th`).outerWidth()),s=t.getFactWidthOfNeighborColumn(o),l=i.find(`.${o}_th .resize-table-hook-caret`),c=0,d=45-n;"report"==t.tableOptions.tableKind&&0==r&&(d+=315);var u=-(45-s);l.css("display","inline-block");var p=null;function h(e){document.body.style.cursor="default",document.onmouseup=null,document.onmousemove=null;if(null!=p&&(c=p),l.css("height",30),l.css("display","none"),l.css("right",""),e.pageX<0)l.css("background-color","");else{e.pageX;if(!(Math.abs(c)<=2)){var a,r=t.tableOptions.showedColumns.indexOf(o),n=t.tableOptions.showedColumns[r+1],s=c/i.width()*100,d=parseFloat(i.find(`colgroup col.${o}_td`)[0].style.width.replace("%"));i.find(`colgroup col.${n}_td`).length>0&&(a=parseFloat(i.find(`colgroup col.${n}_td`)[0].style.width.replace("%")),i.find(`colgroup col.${o}_td`).width(d+s+"%"),i.find(`colgroup col.${n}_td`).width(a-s+"%"))}}}l.css("height",window.innerHeight-$(t.tableOptions.tableWrapperSelector).offset().top-5),document.body.style.cursor="ew-resize",document.onmousemove=function(t){var e=t.pageX;if(e<0)h(t);else{c=e-a;null==(p=c>=u?u:c<=d?d:null)?(l.css("right",-1*c),l.css("background-color")&&l.css("background-color","")):(l.css("background-color","rgba(200, 10,20,0.6)"),l.css("right",-1*p))}},document.onmouseup=function(t){h(t)}}))},this.reinitRows=function(){var t=o.makeRowsArray(this.tableData,this.tableOptions);this.insertRowsInTable(t)},this.makeShowHideReportButtonsAlive=function(){var t=this;$("body").on("click",".report_row_toggler",(function(e){e=e||event;var a=$(this).parent().parent().parent();$(this).hasClass("report_row_toggler_up")?($(this).removeClass("report_row_toggler_up"),$(this).addClass("report_row_toggler_down"),t.hideRowsBelow(a)):($(this).removeClass("report_row_toggler_down"),$(this).addClass("report_row_toggler_up"),t.showRowsBelow(a)),e.stopPropagation(),e.stopImmediatePropagation()}))},this.hideRowsBelow=function(t){for(var e=t.next(),a=t.attr("data-level");e.attr("data-level")>a;)e.css("display","none"),e=e.next()},this.showRowsBelow=function(t){for(var e=t.next(),a=t.attr("data-level");e.attr("data-level")>a;)e.css("display","table-row"),e=e.next()},this.makeSortingByHeaderAlive=function(){var t=this;"stats"==this.tableOptions.tableKind&&$("body").on("click",this.tableOptions.tableWrapperSelector+" .tt_header_table th span",(function(){if(!$(this).hasClass("inactive")){var e=$(this).parent().parent().attr("data-column");setTimeout((function(){t.doSort(e)}),10)}}))},this.applySearchOnTableData=t=>{var e=this,a=!1;if(t.startsWith("<{/")&&t.endsWith("/}>")&&t.length>5){a=!0;try{var o=new RegExp(t.slice(3,t.length-3))}catch(t){a=!1}}const{tagSearch:r=!1}=this.tableOptions;let n=null;if(r&&r.startSign&&t[0]===r.startSign){const{column:e=!1,entry:a="full"}=r;e&&(n=a=>a[e]===t.substr(1).toLowerCase())}for(var s=0;s<this.tableData.length;s++){var i=!1;n?n(this.tableData[s])&&(e.tableData[s].hidedFromTt=!1,i=!0):this.tableOptions.findInColumns.forEach((function(r){var n=e.tableData[s][r];if(null==n&&(n=0),"string"!=typeof n&&(n=n.toString()),-1!=n.toLowerCase().indexOf(t.toLowerCase())||a&&0!=o.test(n))return e.tableData[s].hidedFromTt=!1,i=!0,!1})),0==i&&(this.tableData[s].hidedFromTt=!0)}},this.doSearch=function(t){this.applySearchOnTableData(t),this.reinitRows(),BINOM.tt.checkAndSetScrollbar(),this.redrawFooter(),VmStoreSyncing.meaningfulRowsSync()},this.sortArray=function(t,e,a){if(!this.tableOptions.columns[e])return t;if(t.length<=1)return t;var o,r,n;function s(t,e,a){var o=t[e];t[e]=t[a],t[a]=o}function i(t,r,n,i){for(var l=r,c=n,d=t[i];;){if("ASC"==a)for(;o(t[l][e])<o(d[e]);)l++;else for(;o(t[l][e])>o(d[e]);)l++;if(c--,"ASC"==a)for(;o(d[e])<o(t[c][e]);)c--;else for(;o(d[e])>o(t[c][e]);)c--;if(!(l<c))return l;s(t,l,c),l++}}function l(t,a,r){for(var n,s,i,l=Math.round((a+r)/2);l>=a;){for(n=l;n<r;n++){for(i=t[n],s=n;s>=l&&o(t[s-l][e])>o(i[e]);)t[s]=t[s-l],s-=l;t[s]=i}l=Math.round(l/2.2)}return t}return o=this.tableOptions.columns[e].format&&"string"==this.tableOptions.columns[e].format?function(t){return"string"==typeof t?t.toUpperCase().trim():t&&t.toString?t.toString().toUpperCase().trim():""}:function(t){return null===t?0:parseFloat(t)},n="ASC"==a?function(t,e){return t<=e}:function(t,e){return t>=e},r="cap"==e?function(t,e){var o=t.split(" / ");let r;r=2!=o.length?"ASC"==a?1/0:-1/0:o[0]/o[1];var s=e.split(" / ");let i;return i=2!=s.length?"ASC"==a?1/0:-1/0:s[0]/s[1],n(r,i)}:n,function(t){var a=[],n=[0,t.length,2*Math.floor(Math.log(t.length)/Math.log(2))];for(a.push(n);a.length>0;){var s=(n=a.pop())[0],c=n[1],d=n[2];if(0!=d){d--;var u=i(t,s,c,Math.round((s+c)/2));c-u>16&&(n=[u,c,d],a.push(n)),u-s>16&&(n=[s,u,d],a.push(n))}else t=l(t,s,c)}return t=function(t){for(var a=1,n=t.length;a<n;a++){for(var s=t[a],i=a-1;i>=0&&!r(o(t[i][e]),o(s[e]));i--)t[i+1]=t[i];t[i+1]=s}return t}(t)}(t)},this.addArrowToTh=function(t,e){if("string"==typeof t){t=t.toLowerCase();var a=' <img src="'+TEMPLATES_IMAGES+("desc"==t?"down_3.png":"up_3.png")+'" class="direction_sort_icon" >';$(this.tableOptions.tableWrapperSelector+" .direction_sort_icon").remove(),$(`${this.tableOptions.tableWrapperSelector} .${e}_th .header_table_th_content_wrapper span`).prepend(a+" ")}else console.error("addArrowToTh error. Incorrect sortingDirection: "+t+". It needed to be String!.")},this.getSortingDataReport=function(){var t=URLUtils.getGETParamsAsObject(),e={},a=BINOM.tt.tableOptions.reportGroups;return t.order_name?e.order_name=t.order_name:31==a[0]||25==a[0]||26==a[0]?e.order_name="name":e.order_name="clicks",t.order_type?e.order_type=t.order_type:31==a[0]||25==a[0]||26==a[0]?e.order_type="asc":e.order_type="desc",e},this.getSortingData=function(){if("report"===this.tableOptions.tableKind){const{order_type:t,order_name:e}=this.getSortingDataReport();return{direction:t,column:e}}var t=this.StorageUtils.getStorageValue("tt_sorting");if("object"==typeof t)return t;var e={column:this.tableOptions.defaultSortingColumn||"clicks",direction:this.tableOptions.defaultSortingDirection||"DESC"};return this.setSortingData(e),e},this.setSortingData=function(t,e){if("object"==typeof t)this.StorageUtils.setStorageValue("tt_sorting",t),this.sortingOptions=t;else{var a=this.StorageUtils.getStorageValue("tt_sorting");this.sortingOptions[t]=e,a[t]=e,this.StorageUtils.setStorageValue("tt_sorting",a)}},this.doSort=function(t){var a=this.tableOptions.columns[t]||{},o=this,r="DESC"==this.getSortingData().direction?"ASC":"DESC";this.setSortingData({direction:r,column:t});a.format&&a.format,this.addArrowToTh(r,t),setTimeout((function(){o.tableData=o.sortArray(o.tableData,t,r),o.redrawRows(),o.tableOptions.tabOpen&&o.drawLastHourDataInTable(),e.events.emit("dataChange",this.tableData),e.events.emit("dataSort",this.tableData)}),50)},this.setResizeActions=function(){var t=this;$(window).on("resize",(function(){t.correlateTableHeight();var a=i.find(".tt_data_wrapper").width();i.find(".tt_header_wrapper").css("width",a),i.find(".tt_footer_wrapper").css("width",a),e.checkAndSetScrollbar()}))},this.setScrollAction=function(){},this.stretchTableSize=function(){$(".tt_data_wrapper").css("width","100%"),this.tableOptions.tableWidth="100%",$(".tt_header_wrapper").css("width",$(".tt_data_wrapper").width()),$(".tt_footer_wrapper").css("width",$(".tt_data_wrapper").width())},this.checkColumnUnderHiddenTab=function(t){var e=this.tableOptions.columns[t];return!(!e.tab||e.tab==this.tableOptions.tabs.showed)},this.setMaxContentWidth=function(t){var e,a=this.columnsMaxContentWidth(t),o=0;for(e in a.widths)o+=a.widths[e];$(this.tableOptions.tableWrapperSelector).css("min-width",o+"px"),o,this.tableOptions.columnWidth=a.percents,this.setWidthForColumns()},this.columnsMaxContentWidth=function(t){t=t||{unlimitColumns:[]};var e=this,a={},o={},r=0;$(this.tableOptions.tableWrapperSelector).width();return this.tableOptions.showedColumns.forEach((function(o,n){var s=45;$(".tt_data_table ."+o+"_td span").eq(0).find("input").length>0?s=100:$(".tt_data_table ."+o+"_td span").each((function(e,a){var r=$(a).outerWidth();t.unlimitColumns&&-1!=t.unlimitColumns.indexOf(o)||r>700&&(r=700),r>s&&(s=r)}));var i=$(".tt_footer_table ."+o+"_footer_td span").outerWidth();i>s&&(s=i);var l=$(".tt_header_table ."+o+"_th span").outerWidth();l>s&&(s=l),"report"==e.tableOptions.tableKind&&0==n&&s<350&&(s=350),a[o]=s+16,r+=a[o]})),this.tableOptions.showedColumns.forEach((function(t){o[t]=a[t]/r*100+"%"})),{percents:o,widths:a}},e.dataWrapperWithScroll=!1;var l=0;this.checkAndSetScrollbar=function(){clearTimeout(l),l=setTimeout((function(){var t=i.find(".tt_data_view_wrapper");if(t.hasScrollBar()){if(!e.dataWrapperWithScroll){t.css("overflow-y","scroll");var a=(r=i.find(".tt_header_wrapper"))[0].offsetWidth-e.tableOptions.scrollWidth;r.css("width",a),(n=i.find(".tt_footer_wrapper")).css("width",a),e.dataWrapperWithScroll=!0}}else if(e.dataWrapperWithScroll){t.css("overflow-y","hidden");var o=i.find(".tt_data_view_wrapper")[0].offsetWidth,r=i.find(".tt_header_wrapper"),n=i.find(".tt_footer_wrapper");r.css("width",o),n.css("width",o),e.dataWrapperWithScroll=!1}}),100)},this.stretchTable=function(t){this.addLoadingLayer(),e.setMaxContentWidth(t),e.stretchTableSize(),$(window).trigger("resize"),e.removeLoadingLayer()},this.addLoadingLayer=function(t=!1){let e="";t&&(e="opacity:0.3;"),$(this.tableOptions.tableWrapperSelector).append(`<div style="${e}" class="tt_loading_wrapper"></div>`)},this.removeLoadingLayer=function(){$(".tt_loading_wrapper").remove()},this.setLoadingIcon=function(){},this.clearLoadingIcon=function(){},this.setShowedColumns=function(){this.tableOptions.showedColumns=this.tableOptions.mainSetColumns()},this.init=function(t){r=$(this.tableOptions.tableWrapperSelector).offset().top;this.makeResizeHooksAlive(),this.makeSortingByHeaderAlive(),"report"==this.tableOptions.tableKind&&this.makeShowHideReportButtonsAlive(),this.setResizeActions(),this.draw(),this.setScrollAction()},this.getTableDataIds=function(t){new Array;return void 0!==t?"report"==BINOM.tt.tableOptions.tableKind?t.map((function(t,e){return e})):t.map((function(t){return t.id})):this.tableData.map((function(t){return t.id}))},this.getShowedTableDataIds=function(t){const e=BINOM.tt.tableOptions.unique;var a=new Array;if(void 0!==t){var o=t.filter(t=>!0!==t.hidedFromTt);a="report"==BINOM.tt.tableOptions.tableKind?o.map((function(t,e){return String(e)})):o.map((function(t){return t[e]}))}else{a=(o=this.tableData.filter(t=>!0!==t.hidedFromTt)).map((function(t){return t[e]}))}return a},this.getCheckedMeaningful=function(){if(void 0!==this.markedRows.checked)return this.markedRows.checked.filter(t=>!(!0===BINOM.tt.tableData.findObjectByProp("id",t).hidedFromTt))},this.getSelectedMeaningful=function(){if(void 0!==this.markedRows.selected)return this.markedRows.selected.filter(t=>!(!0===BINOM.tt.tableData.findObjectByProp("id",t).hidedFromTt))},this.fetchViaPrintDataAsJSON=function({queryOptions:t}){const e=URLUtils.getGETParamsAsObject();e.printdataasjson=1;for(let a in t)e[a]=t[a];const a=URLUtils.getURLWithNewGETS(e);return fetch(a,{method:"GET",credentials:"include"}).then(t=>t.json()).then(t=>{let e=!1;if(t&&"object"==typeof t){const{status:e=!1,message:a=!1,error:o=!1}=t;if("report"===this.tableOptions.tableKind&&!1!==o||"error"==e&&"auth"==a)return void window.location.reload()}if(t)if(void 0!==t.dataSet){e=t.dataSet||[];const{tableKind:a}=this.tableOptions;t.pageOptions?this.setPageOptions(t.pageOptions):"conversion"!=a&&"report"!=a&&"clicklog"!=a||console.warn('"pageOptions" for table was not passed'),"report"===this.tableOptions.tableKind&&(t.total&&null!=t.dataSet&&0!=t.dataSet.length||(t.total=[],console.warn('"total" for Report table was not passed')),t.total&&this.setTableTotal(t.total),t.amountOfGroup?this.tableOptions.reportLevels=t.amountOfGroup:console.warn('"amountOfGroup" for Report table was not passed'),t.reportGroups?(this.tableOptions.reportGroups=t.reportGroups,VmStoreSyncing.reportGroupsSync(),this.tableOptions.checkbox=TT_checkCheckboxReportEnabled(this.tableOptions.reportGroups)):console.warn('"reportGroups" for Report table was not passed'),Array.isArray(t.tsTokens)?window.vmStore.commit("SET_TRAFFIC_SOURCE_TOKENS",t.tsTokens):console.warn("Traffic Source tokens for Report table was not passed!"),BINOM.ttReportStuff?BINOM.ttReportStuff.checkSetTokenMarks():console.warn("Try to check TokenMarks but ttReportStuff not found!"))}else{if(!Array.isArray(t))throw new Error("Cannot parse data from server!");e=t}else e=[];return this.setData(e),t})},this.refetchData=function(t={}){this.events.emit("startRefetchData");const{loadingLayer:e=!0,saveScroll:a=!0,clearMarked:o=!0,clientSorting:r=!0,serverSorting:n=!1,queryOptions:s={},willDrawCallback:l=(()=>{})}=t;if(e&&!i.find(".tt_loading_wrapper").length){const t=!0;this.addLoadingLayer(t)}o&&(this.markedRows.checked.splice(0),this.markedRows.selected.splice(0),window.VmStoreSyncing.sync()),this.isFetchingData=!0,"report"==this.tableOptions.tableKind&&window.vmStore._mutations.SET_REPORT_LOADING_STATE&&window.vmStore.commit("SET_REPORT_LOADING_STATE",!0);const{checkbox:c}=this.tableOptions;return this.fetchViaPrintDataAsJSON({queryOptions:s}).then(t=>{this.isFetchingData=!1,this.events.emit("dataFetched");const{checkbox:r}=this.tableOptions;let n=!1;return c!==r&&(n=!0),this.redrawRows({saveScroll:a,clearMarked:o,redrawHeader:n,redrawFooter:!0}),this.stretchTable(),e&&this.removeLoadingLayer(),this.tableOptions.tabOpen&&this.loadLastHour(),"report"===this.tableOptions.tableKind&&(this.redrawFooter(),this.tableOptions.checkbox&&!c&&(this.handlersState.checkbox||TT_addCheckboxDefaultHandlers(),this.handlersState.checkboxAll||TT_addCheckboxAllHandler())),"report"==this.tableOptions.tableKind&&window.vmStore._mutations.SET_REPORT_LOADING_STATE&&window.vmStore.commit("SET_REPORT_LOADING_STATE",!1),t}).catch(t=>{console.error(t),this.isFetchingData=!1,e&&this.removeLoadingLayer(),"report"==this.tableOptions.tableKind&&window.vmStore._mutations.SET_REPORT_LOADING_STATE&&window.vmStore.commit("SET_REPORT_LOADING_STATE",!1)})},this.onColumnsSettingsChanged=function(){const t=parseColumnsSettingsToTTSettings(BINOM.tt.tableOptions.columnsSettings);BINOM.tt.columns=t.columns;BINOM.tt.tableOptions.mainSetColumns;const e=t.mainSetColumns;if(BINOM.tt.tableOptions.mainSetColumns=t.mainSetColumns,BINOM.tt.tableOptions.tabOpen||(BINOM.tt.tableOptions.showedColumns=t.mainSetColumns),BINOM.tt.tableOptions.availableColumns=t.availableColumns,BINOM.tt.tableData.length>0)for(let t=0;t<e.length;t++)if(void 0===BINOM.tt.tableData[0][e[t]])return void this.refetchData().then(()=>this.redraw());this.redraw()},this.searchInputElement=null,this.addSearch=function(t){var e=0;let a;if("string"==typeof t)a=document.querySelector(t);else{if(!(t instanceof Element))throw new Error("Incorrect type of search input!");a=t}this.searchInputElement=a,a.value&&a.value.trim()&&this.applySearchOnTableData(a.value),$(a).on("input",()=>{clearTimeout(e),e=setTimeout(()=>{!function(t){if(BINOM._localStorageIsActive){var e=getURLParameter("page").toLowerCase(),a=localStorage.getItem("searching");""==e&&(e="campaigns"),"campaigns"!=e&&"landing_page"!=e&&"offers"!=e||(a?((a=JSON.parse(a))[e]=t,localStorage.setItem("searching",JSON.stringify(a))):((a={})[e]=t,localStorage.setItem("searching",JSON.stringify(a))))}}(a.value),this.doSearch(a.value),"function"==typeof BINOM.tt.tableOptions.setButtonState&&BINOM.tt.tableOptions.setButtonState()},300)})}}},1029:function(t,e,a){"use strict";function o(){return-1!=navigator.userAgent.indexOf("Opera")?"Opera":-1!=navigator.userAgent.indexOf("MSIE")||-1!=navigator.userAgent.indexOf("Edge")||1==!!document.documentMode?"IE":-1!=navigator.userAgent.indexOf("OPR")?"Opera":-1!=navigator.userAgent.indexOf("Chrome")?"Chrome":-1!=navigator.userAgent.indexOf("Safari")?"Safari":-1!=navigator.userAgent.indexOf("Firefox")?"Firefox":"unknown"}function r(t){const{key_name:e="unknown column"}=t;if(!t.footerCalc)throw new Error("Have not footerCalc in "+e);if(!t.footerCalc.neededColumns)throw new Error("Have not neededColumns in "+e);if(!t.footerCalc.calcFunc)throw new Error("CalcFunc is not passed in "+e);if("string"!=typeof t.footerCalc.calcFunc)throw new Error("CalcFunc is not String in "+e);const{footerCalc:{calcFunc:a,neededColumns:o}}=t;let r=a,n="";t.footerCalc.neededColumns.forEach(t=>{/^[a-zA-Z0-9_]*$/gi.test(t)?n+=`var ${t}=parseFloat(total.${t}) || 0;`:(console.warn(`Strange column: ${t}. When calculating total it will be equal zero.`),n+=`var ${t}=0;`)});const s=new Function("total",`${n} return ${r};`);return function(t){try{const e=s(t);return isFinite(e)?e:0}catch(t){return console.error(t),console.error(`Cannot calculate total from ${e} formula: `),console.error("  calcFunc: "+a),console.error("  Formula: "+r),0}}}function n(t){if(!(BINOM.tt.markedRows.checked.length>0)){var e=t.hasClass("selected_row");if($(".selected_row").removeClass("selected_row"),BINOM.tt.markedRows.selected=new Array,!e){let e;t.addClass("selected_row"),e=t.attr("id")?t.attr("id").replace("ttrowuid",""):t.attr("data-tt-row-uid"),void 0!==e&&(BINOM.tt.markedRows.selected.push(e),BINOM.tt.markedRows.lastMarked=e)}VmStoreSyncing.selectedRowsSync()}}function s(t,e){var a="";a="report"==BINOM.tt.tableOptions.tableKind?".tt_data_wrapper tr td .cute_checkbox":".tt_data_wrapper tr td.cell_with_checkbox",$(BINOM.tt.tableOptions.tableWrapperElement).on("click",a,(function(t){if(t=t||event,!$(t.target).hasClass("noncheckrow")){var a="report"==BINOM.tt.tableOptions.tableKind?$(this).parent().parent().parent().parent():$(this).parent(),o=a.attr("id").replace("ttrowuid",""),r="report"==BINOM.tt.tableOptions.tableKind?$(this):$(this).find(".checkrow");if($(".selected_row").removeClass("selected_row"),BINOM.tt.markedRows.selected=new Array,VmStoreSyncing.selectedRowsSync(),"report"==BINOM.tt.tableOptions.tableKind&&BINOM.ttReportStuff.redrawFooter(!0),BINOM.keyPressed.shift){if("report"==BINOM.tt.tableOptions.tableKind)return;const t=BINOM.tt.tableOptions.unique;BINOM.tt.tableData.findObjectByProp(t,o,!0);if(BINOM.tt.markedRows.checked.length>0){var n=BINOM.tt.markedRows.checked[BINOM.tt.markedRows.checked.length-1],s=BINOM.tt.tableData.findObjectByProp(t,n,!0),i=BINOM.tt.tableData.findObjectByProp(t,o,!0);if(i>s)var l=s+1,c=i;else l=i,c=s-1;for(var d=l;d<=c;d++){var u=BINOM.tt.tableData[d][t];BINOM.tt.markedRows.checked.includes(u)||BINOM.tt.tableData[d].hidedFromTt||BINOM.tt.markedRows.checked.push(u),$("#ttrowuid"+u).addClass("checked_row").find(".cute_checkbox").addClass("checked")}return BINOM.tt.markedRows.lastMarked=c,void VmStoreSyncing.checkedRowsSync()}return r.addClass("checked"),a.addClass("checked_row"),BINOM.tt.markedRows.checked.push(o),BINOM.tt.markedRows.lastMarked=o,void VmStoreSyncing.checkedRowsSync()}if(r.hasClass("checked")){r.removeClass("checked"),a.removeClass("checked_row"),BINOM.tt.markedRows.checked.splice(BINOM.tt.markedRows.checked.indexOf(o),1),BINOM.tt.markedRows.lastMarked=o;var p=$(".tt_header_wrapper ."+BINOM.tt.tableOptions.checkbox+"_th .cute_checkbox");p.length>0&&p.hasClass("checked")&&p.removeClass("checked")}else r.addClass("checked"),a.addClass("checked_row"),BINOM.tt.markedRows.checked.push(o),BINOM.tt.markedRows.lastMarked=o;VmStoreSyncing.checkedRowsSync(),t.stopImmediatePropagation(),t.stopPropagation(),"function"==typeof e&&e()}})),BINOM.tt.handlersState.checkbox=!0}function i(t,e){$(BINOM.tt.tableOptions.tableWrapperElement).on("click",".tt_header_wrapper .cell_with_checkbox .cute_checkbox",(function(){if($(this).hasClass("checked"))$(this).removeClass("checked"),$(".tt_data_wrapper .cute_checkbox.checked").removeClass("checked").parent().parent().parent().parent().removeClass("checked_row"),BINOM.tt.markedRows.checked.splice(0);else{$(this).addClass("checked"),$(".tt_data_wrapper .cute_checkbox:not(.checked)").addClass("checked").parent().parent().parent().parent().addClass("checked_row");var t=BINOM.tt.getShowedTableDataIds(BINOM.tt.tableData);BINOM.tt.markedRows.checked=t,$(".selected_row").removeClass("selected_row"),BINOM.tt.markedRows.selected.splice(0)}VmStoreSyncing.checkedRowsSync(),VmStoreSyncing.selectedRowsSync(),"function"==typeof e&&e()})),BINOM.tt.handlersState.checkboxAll=!0}function l(t,e){const a=[];BINOM.tt.tableOptions.rowClickableElements&&Object.keys(BINOM.tt.tableOptions.rowClickableElements).forEach(t=>a.push(t)),$(BINOM.tt.tableOptions.tableWrapperElement).on("click",".tt_data_wrapper tr",(function(t){const o=$(t.target);let r;if(a.some(t=>!!o.is(t)&&(r=t,!0))){const t=BINOM.tt.tableOptions.rowClickableElements[r];let e;e=$(this).attr("id")?$(this).attr("id").replace("ttrowuid",""):$(this).attr("data-tt-row-uid");const a=BINOM.tt.tableOptions.unique;t(BINOM.tt.tableData.find(t=>t[a]==e))}else if(t=t||event,!$(t.target).hasClass("noncheckrow")){if("report"==BINOM.tt.tableOptions.tableKind){if($(t.target).hasClass("report_row_toggler"))return;n($(this))}else n($(this));"function"==typeof e&&e()}}))}function c(t,e){$(BINOM.tt.tableOptions.tableWrapperElement).on("dblclick",".tt_data_wrapper tr",(function(){var t;$(this).attr("id")&&(t=$(this).attr("id").replace("ttrowuid","")),"function"==typeof e&&e(t)}))}function d(t,e){$(t.tableOptions.tableWrapperSelector).on("click",".tt_data_wrapper tr",(function(t){t=t||window.event;if(0==BINOM.tt.markedRows.checked.length&&!$(t.target).hasClass("report_row_toggler")){var e=$(this),a=e.attr("id").replace("ttrowuid","");if(BINOM.keyPressed.shift)if(BINOM.tt.markedRows.selected.length>0){var o=e.hasClass("selected_row"),r=o?+BINOM.tt.markedRows.lastMarked:+BINOM.tt.markedRows.selected[BINOM.tt.markedRows.selected.length-1];if(a>r)var n=r+1,s=+a;else n=+a,s=r-1;if(o)for(var i=n;i<=s;i++){let t=i.toString();BINOM.tt.markedRows.selected.includes(t)&&BINOM.tt.markedRows.selected.remove(t),$("#ttrowuid"+i).removeClass("selected_row"),BINOM.ttReportStuff.onSelectRowHandler&&BINOM.ttReportStuff.onSelectRowHandler(t)}else for(i=n;i<=s;i++){let t=i.toString();BINOM.tt.markedRows.selected.includes(t)||BINOM.tt.markedRows.selected.push(t),$("#ttrowuid"+i).addClass("selected_row"),BINOM.ttReportStuff.onSelectRowHandler&&BINOM.ttReportStuff.onSelectRowHandler(t)}}else e.addClass("selected_row"),BINOM.tt.markedRows.selected.push(a),BINOM.tt.markedRows.lastMarked=a;else e.hasClass("selected_row")?(e.removeClass("selected_row"),BINOM.tt.markedRows.selected.remove(a)):(e.addClass("selected_row"),BINOM.tt.markedRows.selected.push(a)),BINOM.tt.markedRows.lastMarked=a,BINOM.ttReportStuff.onSelectRowHandler&&BINOM.ttReportStuff.onSelectRowHandler(a);BINOM.tt.markedRows.selected.length>0?$("#drilldown").css("display","inline-block"):$("#drilldown").css("display","none"),VmStoreSyncing.selectedRowsSync(),$(window).trigger("resize")}}))}function u(t){if(void 0===t)throw new Error("Options for TT was not passed!");if("object"==typeof t&&!t.length)return t;if(Array.isArray(t))for(var e=Object.assign({},t[0]),a=0;a<t.length;a++)for(var o in t[a])if("columns"==o&&t[a][o])for(var r in t[a][o])e[o][r]=t[a][o][r];else void 0!==t[a][o]&&(e[o]=t[a][o]);return e}function p(t){var e=Object.create(null),a=new Array,o=new Array;return t.forEach((function(t){var n=Object.create(null);if(a.push(t.key_name),1==t[BINOM.__page]&&o.push(t.key_name),TT_DEFAULT_OPTIONS.columns[t.key_name]?((n=Object.assign({},TT_DEFAULT_OPTIONS.columns[t.key_name])).name=t.name,n.measure=t.measure):n={name:t.name,key:t.key_name,measure:t.measure,format:1==t.is_text?"string":"number"},n.formatters||(n.formatters=[]),-1==TT_DEFAULT_OPTIONS.listOfStringColumns.indexOf(t.key_name)&&"#t#"!=t.measure&&"id"!=t.key_name&&n.formatters.push("threenumeralcommas"),"#t#"==t.measure?-1==n.formatters.indexOf("timevalue")&&n.formatters.push("timevalue"):"%"==t.measure?-1==n.formatters.indexOf("percentagesign")&&n.formatters.push("percentagesign"):"$"==t.measure?(-1==n.formatters.indexOf("dollarsign")&&n.formatters.push("dollarsign"),-1==n.formatters.indexOf("brackets")&&n.formatters.push("brackets")):t.measure&&""!=t.measure&&0!=t.measure&&-1==n.formatters.indexOf("custommeasure")&&n.formatters.push("custommeasure"),void 0===t.footer&&t.total_type)if("1"==t.total_type)n.footer="sum";else if("2"==t.total_type||"3"==t.total_type){const{formula:e=!1}=t;if(!1!==e){n.footerCalc={basedOnFinal:!0,neededColumns:[],calcFunc:e},"2"==t.total_type?n.footer="average":"3"==t.total_type&&(n.footer="averageSmart");e.split(/[\+\-\*\/\(\)\^]/).forEach(t=>{const e=t.trim();""==e||n.footerCalc.neededColumns.includes(e)||/^[0-9\,\.]+$/.test(e)||n.footerCalc.neededColumns.push(e)}),n.footerCalc.calcFunc=r(n),n.footerCalc.calcFuncGeneratedFromFormula=!0}}"profit"!=t.key_name&&"roi"!=t.key_name||n.formatters.push("redgreengrey"),e[t.key_name]=n})),{columns:e,availableColumns:a,mainSetColumns:o}}window.TEMPLATES_IMAGES="./templates/standart/images/",window.filePreloader={files:[TEMPLATES_IMAGES+"up_3.png",TEMPLATES_IMAGES+"down_3.png",TEMPLATES_IMAGES+"logo-binom.png",TEMPLATES_IMAGES+"settings.png"],preloadFiles:function(){this.files.forEach((function(t){document.createElement("img").src=t}))}},window.asyncAnimation='<div class="uil-async-css" style="transform:scale(0.05);margin-right:10px;margin-bottom:5px;"><div></div><div></div></div>',filePreloader.preloadFiles(),window.clearLSReload=function(){localStorage.removeItem("campaigns_columnsWidth"),localStorage.removeItem("campaigns_showedColumns"),window.location.reload()},window.TT_DEFAULT_OPTIONS={columns:{name:{key:"name",name:"Name",align:"left",format:"string"},login:{key:"login",name:"Login",align:"left",format:"string"},id:{key:"id",name:"ID",align:"right"},unique_clicks:{key:"unique_clicks",name:"U. Clicks",formatters:["threenumeralcommas"]},unique_camp_clicks:{key:"unique_camp_clicks",name:"U. Camp Clicks",formatters:["threenumeralcommas"]},offers:{key:"offers",name:"Offers"},group_name:{key:"group_name",name:"Group",tab:"stat",format:"string",formatters:["zeroempty"]},ts_name:{key:"ts_name",tab:"stat",name:"Traffic Source",format:"string"},camps:{key:"camps",tab:"stat",name:"Campaigns",format:"integer"},tokens:{key:"tokens",tab:"stat",name:"Tokens",format:"integer",formatters:["yesno"]},geo:{key:"geo",name:"Geo",format:"string",formatters:["zeronone","oneisglobal"]},network_name:{key:"network_name",name:"Network",format:"string",formatters:["zeroempty"]},click_id:{key:"click_id",name:"Click ID",align:"left"},camp_name:{key:"camp_name",name:"Campaign"},offer_name:{key:"offer_name",name:"Offer Name"},click_time:{key:"click_time",name:"Time Click"},cr:{key:"cr",name:"CR",tab:"stat",formatters:["decimalplaces"],footer:!0,footerCalc:{basedOnFinal:!0,neededColumns:["leads","clicks"],calcFunc:function(t){var e=t.leads;return(void 0===e||isNaN(e))&&(e=t.cnt_cnv),t.clicks>0?e/t.clicks*100:0}}},epc:{key:"epc",name:"EPC",tab:"stat",formatters:["decimalplaces","threenumeralcommas"],footer:!0,footerCalc:{basedOnFinal:!0,neededColumns:["clicks","revenue"],calcFunc:function(t){var e=t.revenue;return(void 0===e||isNaN(e))&&(e=t.summ_cnv),t.clicks>0?e/t.clicks:0}}},revenue:{key:"revenue",name:"Revenue",tab:"stat",formatters:["decimalplaces","threenumeralcommas"],footer:!0,footerCalc:"sum"},summ_cnv:{key:"summ_cnv",name:"Revenue",tab:"stat",formatters:["decimalplaces","threenumeralcommas"],footer:!0,footerCalc:"sum"},cost:{key:"cost",formatters:["decimalplaces","threenumeralcommas"],tab:"stat",name:"Cost",footer:!0},Spend:{key:"Spend",formatters:["decimalplaces","threenumeralcommas"],tab:"stat",name:"Cost",footer:!0},profit:{key:"profit",name:"Profit",footer:!0,footerCalc:"sum",formatters:["decimalplaces","threenumeralcommas"],stat:!1,align:"right",bold:!0},lp_ctr:{key:"lp_ctr",name:"LP CTR",tab:"stat",footer:!0,footerCalc:{basedOnFinal:!0,neededColumns:["lp_views","lp_clicks"],calcFunc:function(t){return t.lp_views>0?t.lp_clicks/t.lp_views*100:0}},formatters:["decimalplaces","threenumeralcommas"],stat:!1,align:"right"},roi:{key:"roi",name:"ROI",footer:!0,footerCalc:{basedOnFinal:!0,neededColumns:["cost","profit"],calcFunc:function(t){var e=(+t.profit).toFixed(5),a=(+t.cost).toFixed(5);return 0==a?0:e/a*100}},formatters:["decimalplaces","threenumeralcommas"],stat:!1,align:"right",bold:!0},clicks:{key:"clicks",name:"Clicks",footer:!0,footerCalc:"sum",formatters:["threenumeralcommas"],align:"right"},cpc:{key:"cpc",name:"CPC",tab:"stat",formatters:["decimalplaces","threenumeralcommas"],footer:!0,footerCalc:{basedOnFinal:!0,neededColumns:["clicks","cost"],calcFunc:function(t){var e=t.cost;return(void 0===e||isNaN(e))&&(e=t.Spend),t.clicks>0?e/t.clicks:0}}},leads:{key:"leads",name:"Leads",tab:"stat",footer:!0,footerCalc:"sum",formatters:["threenumeralcommas"]},cnt_cnv:{key:"cnt_cnv",name:"Leads",tab:"stat",footer:!0,footerCalc:"sum"},url:{key:"url",name:"Link",tab:"info",formatters:["readonlyinput"]},start_date:{key:"start_date",name:"Start Date",tab:"info",formatters:["zeroempty","timestamptodate"]},current_cpc:{key:"current_cpc",name:"Current CPC",tab:"info",formatters:[]},clicks_lh:{key:"clicks_lh",align:"right",name:"CLH",async:!0,tab:"info",formatters:[]},leads_lh:{key:"leads_lh",name:"LLH",async:!0,tab:"info",formatters:[]},profit_lh:{key:"profit_lh",name:"PLH",async:!0,tab:"info",formatters:["dollarsign","redgreengrey"]},last_lead:{key:"last_lead",name:"Last Lead",async:!0,tab:"info",formatters:[]},ea:{key:"ea"},a_leads:{key:"a_leads",footer:!0,footerCalc:"sum"},approve:{key:"approve",footer:!0,footerCalc:{basedOnFinal:!0,neededColumns:["event_2","leads"],calcFunc:function(t){var e=t.event_2,a=t.leads;return 0==a?0:e/a*100}}},r_leads:{key:"r_leads",footer:!0,footerCalc:"sum"},reject:{key:"reject",footer:!0,footerCalc:{basedOnFinal:!0,neededColumns:["event_3","leads"],calcFunc:function(t){var e=t.event_3,a=t.leads;return 0==a?0:e/a*100}}},r_revenue:{key:"r_revenue",footer:!0,footerCalc:"sum"},h_leads:{key:"h_leads",footer:!0,footerCalc:{basedOnFinal:!0,neededColumns:["leads","event_2","event_3"],calcFunc:function(t){return t.leads-t.event_2-t.event_3}}},hold:{key:"hold",footer:!0,footerCalc:{basedOnFinal:!0,neededColumns:["leads","event_2","event_3"],calcFunc:function(t){var e=t.leads,a=t.event_2,o=t.event_3;return 0==e?0:(e-a-o)/e*100}}},h_revenue:{key:"hold",footer:!0,footerCalc:{basedOnFinal:!0,neededColumns:["event_1","revenue","event_4"],calcFunc:function(t){return t.event_1-t.revenue-t.event_4}}},e_revenue:{key:"hold",footer:!0,footerCalc:"sum"},e_profit:{key:"e_profit",footer:!0,footerCalc:"sum"},e_roi:{key:"e_roi",footer:!0,footerCalc:{basedOnFinal:!0,neededColumns:["event_1","e_profit","cost"],calcFunc:function(t){const e=t.e_profit;if(void 0!==e&&!isNaN(e)){const a=t.cost;return 0==a?0:e/a*100}return 0}}},ecpa:{key:"ecpa",footer:!0,footerCalc:{basedOnFinal:!0,neededColumns:["revenue","leads"],calcFunc:function(t){var e=t.revenue,a=t.leads;return 0==a?0:e/a}}},rebills:{key:"rebills",footer:!0,footerCalc:"sum"},unsubs:{key:"unsubs",footer:!0,footerCalc:"sum"},buyouts:{key:"buyouts",footer:!0,footerCalc:"sum"},unsubs_prc:{key:"unsubs_prc",footer:!0,footerCalc:{basedOnFinal:!0,neededColumns:["event_6","leads"],calcFunc:function(t){var e=t.event_6,a=t.leads;return 0==a?0:e/a*100}}},ros:{key:"ros",footer:!0,footerCalc:{basedOnFinal:!0,neededColumns:["event_5","leads"],calcFunc:function(t){var e=t.event_5,a=t.leads;return 0==a?0:e/a}}},inst_unsubs:{key:"inst_unsubs",footer:!0,footerCalc:"sum"},event_1:{key:"event_1",name:"Event 1",footer:!0,footerCalc:"sum"},event_2:{key:"event_2",name:"Event 2",footer:!0,footerCalc:"sum"},event_3:{key:"event_3",name:"Event 3",footer:!0,footerCalc:"sum"},event_4:{key:"event_4",name:"Event 4",footer:!0,footerCalc:"sum"},event_5:{key:"event_5",name:"Event 5",footer:!0,footerCalc:"sum"},event_6:{key:"event_6",name:"Event 6",footer:!0,footerCalc:"sum"},event_7:{key:"event_7",name:"Event 7",footer:!0,footerCalc:"sum"},event_8:{key:"event_8",name:"Event 8",footer:!0,footerCalc:"sum"},event_9:{key:"event_9",name:"Event 9",footer:!0,footerCalc:"sum"},event_10:{key:"event_10",name:"Event 10",footer:!0,footerCalc:"sum"}},deletedStatus:"status",findInColumns:["name"],tabs:{showed:"stat",tabs:["info","stat"]},unique:"id",tableKind:"stats",reportLevelProp:"Level",defaultShowedColumnSettings:{columns:{event_3:!1,event_4:!1,event_5:!1,event_6:!1,event_7:!1,event_8:!1,event_9:!1,event_10:!1,unique_camp_clicks:!1,unique_clicks:!1}},listOfStringColumns:["name","group_name","role","traffic_source","ts_name","geo","lang","network","login","click_id","md5_name"]},window.findObjectInArray=function(t,e,a){for(var o=0;o<t.length;o++)if(t[o][e]==a)return t[o];return!1},jQuery.fn.hasScrollBar=function(t){return"vertical"==(t=t||"vertical")?this.get(0).scrollHeight>this.innerHeight():"horizontal"==t&&this.get(0).scrollWidth>this.innerWidth()},window.checkForTrColorize=function(t,e){void 0===t&&(t=0);void 0===e&&(e=0);var a={greenColor:{light:"200,230,201",dark:"50,205,50"},redColor:{light:"255,204,188",dark:"128,0,0"}},o=window.$rootStore.state.Settings.settings.appearance||"light",r="";r+=e<0?"tr_profit_3":e>0?"tr_profit_1":"tr_profit_2";if(1==window.TT_COLORIZE){var n=0,s="";t>0?(s="green",t<200?n=t/200:t>=200&&(n=1)):t<0&&(s="red",t>-100?n=-t/100:t<=-100&&(n=1)),(n=n.toFixed(2))<.1&&(n=.1),"dark"===o&&(n/=2);var i="";"green"==s?i=`background-color: rgba(${a.greenColor[o]},${n});`:"red"==s&&(i=`background-color: rgba(${a.redColor[o]},${n});`)}return[i,r]},window.getProportianalTransparentCellColor=function(t,e,a,o=!1){var r,n,s,i;t=parseFloat(t),e=parseFloat(e),r=(a=parseFloat(a))<0?"rgba(255,204,188,":"rgba(200,230,201,";t<0?(s=a<0?Math.abs(t):e,a=Math.abs(a)):(s=Math.abs(e-t),a=Math.abs(a-t));n=(n=(a/s).toFixed(4))<.05?.05:n,0==a&&(n=0);n>.7&&(i="#000000");return{bgColor:r+=n+")",fontColor:i}},window.checkBrowser=o,window.getScrollWidth=function(){return{Opera:5,IE:25,Chrome:5,Safari:5,Firefox:17,unknown:25}[o()]},window.makeFunctionForTotalFromColumnFormula=r,window.markRow=n,window.TT_addCheckboxDefaultHandlers=s,window.TT_addCheckboxAllHandler=i,window.TT_addRowClickDefaultHandlersStats=l,window.TT_addRowDblClickDefaultHandlers=c,window.TT_addRowClickDefaultHandlersReport=d,window.TT_addRowDblClickDefaultHandlersReport=function(t,e){$(t.tableOptions.tableWrapperSelector).on("dblclick",".tt_data_wrapper tr",(function(){}))},window.summOptions=u,window.parseColumnsSettingsToTTSettings=p,window.setDefaultValuesForTTOptions=t=>(t.tableWrapperSelector||(t.tableWrapperSelector="#table-block"),t.tableWrapperElement=document.querySelector(t.tableWrapperSelector),void 0===t.fullWindowHeight&&(t.fullWindowHeight=!0),t),window.makeTTInstance=t=>{var e=Object.create(null);if(t.columnsSettings)e=p(t.columnsSettings);let a=u([TT_DEFAULT_OPTIONS,t,e]);return setDefaultValuesForTTOptions(a),"undefined"!=typeof BINOM&&BINOM.__pageType?a.uid=BINOM.__pageType:a.uid=Date.now(),TtFactory(a)},window.setDataToTTInstance=(t,e)=>(null==t?e.setData(t):t.dataSet?(e.setData(t.dataSet),t.total&&e.setTableTotal(t.total),t.pageOptions&&e.setPageOptions(t.pageOptions)):e.setData(t),e),window.TT_makeTT=function(t,e,a,o){BINOM.tt=makeTTInstance(e),BINOM.tt=setDataToTTInstance(t,BINOM.tt),BINOM.ttSettingsAvailable&&"clicklog"!=BINOM.__page&&drawTTSettingsIcon();BINOM.tt.tableOptions.setButtonState=a,BINOM.tt.tableOptions.checkbox&&(s(BINOM.tt,(function(){a()})),i(BINOM.tt,a));"report"==BINOM.tt.tableOptions.tableKind?d(BINOM.tt):l(BINOM.tt,a);c(BINOM.tt,o),BINOM.ttKeyboard?BINOM.ttKeyboard.init():console.warn("BINOM.ttKeyboard undefined. go without");-1!=["campaigns","landing_page","offers","affiliate_networks","traffic_sources","rotations","users"].indexOf(BINOM.__pageType)&&$("[name=search_name]").length&&BINOM.tt.addSearch("[name=search_name]");BINOM.tt.init()},window.TT_checkCheckboxReportEnabled=function(t){var e=!1;if(t&&void 0!==t[0]){var a=t[0];(27==a||a>=282&&a<=290)&&1==t[1]&&1==t[2]&&(e=!0)}return e}}});